<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>NetEMD Network Earth Mover's Distance between a pair of networks. — netemd_one_to_one • netdist</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="NetEMD Network Earth Mover's Distance between a pair of networks. — netemd_one_to_one"><meta property="og:description" content="Calculates the network Earth Mover's Distance (EMD) between 
two sets of network features. This is done by individually normalising the distribution
of each feature so that they have unit mass and unit variance. Then the minimun EMD between the same pair of features (one for each corresponding graph) is calculated by considering all possible translations of the feature distributions. Finally the average over all features is reported.
This is calculated as follows:
  1. Normalise each feature histogram to have unit mass and unit variance.
  2. For each feature, find the minimum EMD between each pair of histograms considering all possible  histogram translations.
  3. Take the average minimum EMD across all features."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">netdist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.9100</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/ManyToMany.html">Simple and quick (default) usage 3: many to many comparisons</a>
    </li>
    <li>
      <a href="../articles/NetEmdTimeOrdering.html">NetEmd: World trade</a>
    </li>
    <li>
      <a href="../articles/NetdisGPStepByStep.html">Netdis-GP: step by step</a>
    </li>
    <li>
      <a href="../articles/NetdisStepByStep.html">Netdis: step by step</a>
    </li>
    <li>
      <a href="../articles/NewNetdisCustomisations.html">Netdis: customizations</a>
    </li>
    <li>
      <a href="../articles/PreComputedProps.html">Simple and quick (default) usage 2: pre-computed properties</a>
    </li>
    <li>
      <a href="../articles/V-Menu.html">Netdis Vignette's Menu</a>
    </li>
    <li>
      <a href="../articles/default_pairwise_usage.html">Simple and quick (default) usage 1: pairwise comparisons</a>
    </li>
    <li>
      <a href="../articles/dendrogram_example_net_dis.html">Netdis: Protein interaction networks</a>
    </li>
    <li>
      <a href="../articles/dendrogram_example_net_emd.html">Dendrogram example for NetEMD</a>
    </li>
    <li>
      <a href="../articles/netdis_customisations.html">Usage of netdis with binning and expected counts customisations.</a>
    </li>
    <li>
      <a href="../articles/netdis_pairwise_comparisons.html">Usage of netdis interfaces for different pairwise comparison options.</a>
    </li>
    <li>
      <a href="../articles/quickstart_netdis_2graphs.html">Quick start guide for Netdis - 2 graphs</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>NetEMD Network Earth Mover's Distance between a pair of networks.</h1>
    
    <div class="hidden name"><code>netemd_one_to_one.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the network Earth Mover's Distance (EMD) between 
two sets of network features. This is done by individually normalising the distribution
of each feature so that they have unit mass and unit variance. Then the minimun EMD between the same pair of features (one for each corresponding graph) is calculated by considering all possible translations of the feature distributions. Finally the average over all features is reported.
This is calculated as follows:
  1. Normalise each feature histogram to have unit mass and unit variance.
  2. For each feature, find the minimum EMD between each pair of histograms considering all possible  histogram translations.
  3. Take the average minimum EMD across all features.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">netemd_one_to_one</span><span class="op">(</span>
  graph_1 <span class="op">=</span> <span class="cn">NULL</span>,
  graph_2 <span class="op">=</span> <span class="cn">NULL</span>,
  dhists_1 <span class="op">=</span> <span class="cn">NULL</span>,
  dhists_2 <span class="op">=</span> <span class="cn">NULL</span>,
  method <span class="op">=</span> <span class="st">"optimise"</span>,
  return_details <span class="op">=</span> <span class="cn">FALSE</span>,
  smoothing_window_width <span class="op">=</span> <span class="fl">0</span>,
  feature_type <span class="op">=</span> <span class="st">"orbit"</span>,
  max_graphlet_size <span class="op">=</span> <span class="fl">5</span>,
  ego_neighbourhood_size <span class="op">=</span> <span class="fl">0</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>graph_1</dt>
<dd><p>A network/graph object from the <code>igraph</code> package. <code>graph_1</code> can be set to <code>NULL</code> (default) if <code>dhists_1</code> is provided.</p></dd>
<dt>graph_2</dt>
<dd><p>A network/graph object from the <code>igraph</code> package. <code>graph_2</code> can be set to <code>NULL</code> (default) if <code>dhists_2</code> is provided.</p></dd>
<dt>dhists_1</dt>
<dd><p>Either, a <code>dhist</code> discrete histogram object, or list of such objects, or a matrix of network features (each column representing a feature). <code>dhists_1</code> can be set to <code>NULL</code> (default) if <code>graph_1</code> is provided. A <code>dhist</code> object can be obtained from <code>graph_features_to_histograms</code>.</p></dd>
<dt>dhists_2</dt>
<dd><p>Same as <code>dhists_1</code>.</p></dd>
<dt>method</dt>
<dd><p>The method to be used to find the minimum EMD across all potential
offsets for each pair of histograms. Default is "optimise" to use
R's built-in <code><a href="https://rdrr.io/r/stats/optimize.html" class="external-link">stats::optimise</a></code> method to efficiently find the offset
with the minimal EMD. However, this is not guaranteed to find the global
minimum if multiple local minima EMDs exist. You can alternatively specify the
"exhaustive" method, which will exhaustively evaluate the EMD between the
histograms at all offsets that are candidates for the minimal EMD at the cost of computational time.</p></dd>
<dt>return_details</dt>
<dd><p>Logical indicating whether to return the individual
minimal EMDs and associated offsets for all pairs of histograms.</p></dd>
<dt>smoothing_window_width</dt>
<dd><p>Width of "top-hat" smoothing window to apply to
"smear" point masses across a finite width in the real domain. Default is 0,
which  results in no smoothing. Care should be taken to select a
<code>smoothing_window_width</code> that is appropriate for the discrete domain
(e.g.for the integer domain a width of 1 is the natural choice).</p></dd>
<dt>feature_type</dt>
<dd><p>Type of graphlet-based feature to count: "graphlet"
counts the number of graphlets each node participates in; "orbit" (default) calculates
the number of graphlet orbits each node participates in.</p></dd>
<dt>max_graphlet_size</dt>
<dd><p>Determines the maximum size of graphlets to count.
Only graphlets containing up to <code>max_graphlet_size</code> nodes will be
counted. Possible values are 4, and 5 (default).</p></dd>
<dt>ego_neighbourhood_size</dt>
<dd><p>The number of steps from the source node to
include nodes for each ego-network. NetEmd was proposed for individual nodes alone, hence the default value is 0.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>NetEMD measure for the two sets of discrete histograms (or graphs). If
(<code>return_details = FALSE</code>) then a list with the following named elements is returned
<code>net_emd</code>: the NetEMD for the set of histogram pairs (or graphs), <code>min_emds</code>:
the minimal EMD for each pair of histograms, <code>min_offsets</code>: the associated
offsets giving the minimal EMD for each pair of histograms</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org" class="external-link">igraph</a></span><span class="op">)</span></span>
<span class="r-in"> <span class="va">graph_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_lattice.html" class="external-link">graph.lattice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span> </span>
<span class="r-in"> <span class="va">graph_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_lattice.html" class="external-link">graph.lattice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>,<span class="fl">44</span><span class="op">)</span><span class="op">)</span> </span>
<span class="r-in"> <span class="fu">netemd_one_to_one</span><span class="op">(</span>graph_1<span class="op">=</span><span class="va">graph_1</span>,graph_2<span class="op">=</span><span class="va">graph_2</span>,feature_type<span class="op">=</span><span class="st">"orbit"</span>,max_graphlet_size<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.216367</span>
<span class="r-in"> </span>
<span class="r-in"> <span class="co">#Providing a matrix of network features</span></span>
<span class="r-in"> <span class="va">props_a</span><span class="op">=</span> <span class="fu"><a href="count_orbits_per_node.html">count_orbits_per_node</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">graph_1</span>,max_graphlet_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"> <span class="va">props_b</span><span class="op">=</span> <span class="fu"><a href="count_orbits_per_node.html">count_orbits_per_node</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">graph_2</span>,max_graphlet_size <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"> </span>
<span class="r-in"> <span class="fu">netemd_one_to_one</span><span class="op">(</span>dhists_1<span class="op">=</span><span class="va">props_a</span>, dhists_2<span class="op">=</span><span class="va">props_b</span>,smoothing_window_width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.174511</span>
<span class="r-in"> </span>
<span class="r-in"> <span class="co">#Providing the network features as lists of dhist objects</span></span>
<span class="r-in"> <span class="va">dhists_1</span><span class="op">&lt;-</span> <span class="fu"><a href="graph_features_to_histograms.html">graph_features_to_histograms</a></span><span class="op">(</span><span class="va">props_a</span><span class="op">)</span></span>
<span class="r-in"> <span class="va">dhists_2</span><span class="op">&lt;-</span> <span class="fu"><a href="graph_features_to_histograms.html">graph_features_to_histograms</a></span><span class="op">(</span><span class="va">props_b</span><span class="op">)</span></span>
<span class="r-in"> </span>
<span class="r-in"> <span class="fu">netemd_one_to_one</span><span class="op">(</span>dhists_1<span class="op">=</span><span class="va">dhists_1</span>, dhists_2<span class="op">=</span><span class="va">dhists_2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.216367</span>
<span class="r-in"> </span>
<span class="r-in"> </span>
<span class="r-in"> <span class="co"># A variation of NetEmd: Using the Laplacian spectrum </span></span>
<span class="r-in"> <span class="co">#Laplacian</span></span>
<span class="r-in"> <span class="va">Lapg_1</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/laplacian_matrix.html" class="external-link">laplacian_matrix</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">graph_1</span>,normalized <span class="op">=</span> <span class="cn">FALSE</span>,sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"> <span class="va">Lapg_2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/laplacian_matrix.html" class="external-link">laplacian_matrix</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">graph_2</span>,normalized <span class="op">=</span> <span class="cn">FALSE</span>,sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"> </span>
<span class="r-in"> <span class="co">#Normalized Laplacian</span></span>
<span class="r-in"> <span class="va">NLapg_1</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/laplacian_matrix.html" class="external-link">laplacian_matrix</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">graph_1</span>,normalized <span class="op">=</span> <span class="cn">TRUE</span>,sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"> <span class="va">NLapg_2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/laplacian_matrix.html" class="external-link">laplacian_matrix</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">graph_2</span>,normalized <span class="op">=</span> <span class="cn">TRUE</span>,sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"> </span>
<span class="r-in"> <span class="co">#Spectra (This may take a couple of minutes).</span></span>
<span class="r-in"> <span class="va">props_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>L.Spectra<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">Lapg_1</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>, NL.Spectra<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">NLapg_1</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span> </span>
<span class="r-in"> <span class="va">props_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>L.Spectra<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">Lapg_2</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>, NL.Spectra<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">NLapg_2</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span> </span>
<span class="r-in"> </span>
<span class="r-in"> <span class="fu">netemd_one_to_one</span><span class="op">(</span>dhists_1 <span class="op">=</span> <span class="va">props_1</span>,dhists_2 <span class="op">=</span> <span class="va">props_2</span>,smoothing_window_width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="co">#Use of smoothing window 1 is given for discrete integer distributions. If the network features are considered continuous variables smoothing_window_width equal to zero is recommended.</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.04998956</span>
<span class="r-in"> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Martin O’Reilly.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

