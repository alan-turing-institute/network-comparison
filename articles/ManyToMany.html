<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simple and quick (default) usage 3: many to many comparisons • netdist</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simple and quick (default) usage 3: many to many comparisons">
<meta property="og:description" content="netdist">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">netdist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.9100</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ManyToMany.html">Simple and quick (default) usage 3: many to many comparisons</a>
    </li>
    <li>
      <a href="../articles/NetEmdTimeOrdering.html">NetEmd: World trade</a>
    </li>
    <li>
      <a href="../articles/NetdisGPStepByStep.html">Netdis-GP: step by step</a>
    </li>
    <li>
      <a href="../articles/NetdisStepByStep.html">Netdis: step by step</a>
    </li>
    <li>
      <a href="../articles/NewNetdisCustomisations.html">Netdis: customizations</a>
    </li>
    <li>
      <a href="../articles/PreComputedProps.html">Simple and quick (default) usage 2: pre-computed properties</a>
    </li>
    <li>
      <a href="../articles/V-Menu.html">Netdis Vignette's Menu</a>
    </li>
    <li>
      <a href="../articles/default_pairwise_usage.html">Simple and quick (default) usage 1: pairwise comparisons</a>
    </li>
    <li>
      <a href="../articles/dendrogram_example_net_dis.html">Netdis: Protein interaction networks</a>
    </li>
    <li>
      <a href="../articles/dendrogram_example_net_emd.html">Dendrogram example for NetEMD</a>
    </li>
    <li>
      <a href="../articles/netdis_customisations.html">Usage of netdis with binning and expected counts customisations.</a>
    </li>
    <li>
      <a href="../articles/netdis_pairwise_comparisons.html">Usage of netdis interfaces for different pairwise comparison options.</a>
    </li>
    <li>
      <a href="../articles/quickstart_netdis_2graphs.html">Quick start guide for Netdis - 2 graphs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Simple and quick (default) usage 3: many to many comparisons</h1>
            
            <h4 data-toc-skip class="date">23/06/2020</h4>
      
      
      <div class="hidden name"><code>ManyToMany.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In some situations there is a need to compare multiple graphs among each other. For such situations, the <code>netdist</code> package contains some initial shortcut functions that perform such calculation and may automatically (Unix) incorporate parallel processing.</p>
<p>This vignette does not show details about the Netdis and NetEmd network comparison methods or their variants, please check <a href="default_pairwise_usage.html">“Simple and quick (default) usage 1: pairwise comparisons”</a> for these details. Instead, this vignette shows the default usage of the shortcut functions for many-to-many comparisons.</p>
<p>Please note that for high performance computations these shortcut functions may not be ideal, particularly in terms of RAM consumption.</p>
<p>For other vignettes in this package see the <a href="V-Menu.html">“Menu”</a>.</p>
</div>
<div class="section level2">
<h2 id="load-required-packageslibraries">Load required packages/libraries<a class="anchor" aria-label="anchor" href="#load-required-packageslibraries"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load packages/libraries</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"netdist"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://igraph.org" class="external-link">"igraph"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"pheatmap"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="compare-multiple-networks-via-netemd">Compare multiple networks via NetEmd<a class="anchor" aria-label="anchor" href="#compare-multiple-networks-via-netemd"></a>
</h2>
<p>(Extracted from Wegner et al. (2017)): NetEmd is based on the idea that the information encapsulated in the shape of the degree distribution and other network properties which reflect the topological organization of the network. From an abstract point of view, NetEmd views the shape of a distribution as a property that is invariant under linear deformations i.e. translations and re-scalings of the axis.</p>
<div class="section level3">
<h3 id="networks-being-compared">Networks being compared<a class="anchor" aria-label="anchor" href="#networks-being-compared"></a>
</h3>
<p>Generation of regular grid, ring and tree-like networks with 400 nodes and 1600 nodes. The plots of these networks illustrate clearly their structural differences.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create networks</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3171</span><span class="op">)</span>
<span class="va">gLat_1</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_lattice.html" class="external-link">graph.lattice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span> 
<span class="va">gLat_2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_lattice.html" class="external-link">graph.lattice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">40</span><span class="op">)</span><span class="op">)</span>  
<span class="va">gRing_1</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_ring.html" class="external-link">make_ring</a></span><span class="op">(</span><span class="fl">20</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> 
<span class="va">gRing_2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_ring.html" class="external-link">make_ring</a></span><span class="op">(</span><span class="fl">40</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="va">gTree_1</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html" class="external-link">as.undirected</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_tree.html" class="external-link">make_tree</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">^</span><span class="fl">2</span>,children <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">)</span>
<span class="va">gTree_2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html" class="external-link">as.undirected</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_tree.html" class="external-link">make_tree</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">40</span><span class="op">^</span><span class="fl">2</span>,children <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gLat_1</span>,vertex.size<span class="op">=</span><span class="fl">0.8</span>,vertex.label<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gLat_2</span>,vertex.size<span class="op">=</span><span class="fl">0.8</span>,vertex.label<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></code></pre></div>
<p><img src="ManyToMany_files/figure-html/netwokrs-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gRing_1</span>,vertex.size<span class="op">=</span><span class="fl">0.8</span>,vertex.label<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gRing_2</span>,vertex.size<span class="op">=</span><span class="fl">0.8</span>,vertex.label<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></code></pre></div>
<p><img src="ManyToMany_files/figure-html/netwokrs-2.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gTree_1</span>,vertex.size<span class="op">=</span><span class="fl">0.8</span>,vertex.label<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gTree_2</span>,vertex.size<span class="op">=</span><span class="fl">0.8</span>,vertex.label<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></code></pre></div>
<p><img src="ManyToMany_files/figure-html/netwokrs-3.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="netemd-using-subgraph-counts">NetEmd using subgraph counts<a class="anchor" aria-label="anchor" href="#netemd-using-subgraph-counts"></a>
</h3>
<p>Subgraph count based NetEmd comparisons:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># NetEMD using subgraph counts.</span>
<span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Lat_1<span class="op">=</span><span class="va">gLat_1</span>, Lat_2<span class="op">=</span><span class="va">gLat_2</span>, Ring_1<span class="op">=</span><span class="va">gRing_1</span>, Ring_2<span class="op">=</span><span class="va">gRing_1</span>, Tree_1<span class="op">=</span><span class="va">gTree_1</span>, Tree_2<span class="op">=</span><span class="va">gTree_2</span><span class="op">)</span>

<span class="va">netemdlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netemd_many_to_many.html">netemd_many_to_many</a></span><span class="op">(</span>graphs <span class="op">=</span> <span class="va">glist</span>,smoothing_window_width <span class="op">=</span> <span class="fl">1</span>,mc.cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co">#Use of smoothing window 1 is given for discrete integer distributions. If the network features are considered continuous variables smoothing_window_width equal to zero is recommended.</span>

<span class="va">netemdlist</span>
<span class="co">#&gt; $netemds</span>
<span class="co">#&gt;  [1] 0.076627846 0.133149779 0.133149779 0.203199795 0.203500020 0.174670019</span>
<span class="co">#&gt;  [7] 0.174670019 0.202314235 0.201886062 0.000000000 0.127115909 0.128284610</span>
<span class="co">#&gt; [13] 0.127115909 0.128284610 0.003359703</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $comp_spec</span>
<span class="co">#&gt;    name_a name_b index_a index_b</span>
<span class="co">#&gt; 1   Lat_1  Lat_2       1       2</span>
<span class="co">#&gt; 2   Lat_1 Ring_1       1       3</span>
<span class="co">#&gt; 3   Lat_1 Ring_2       1       4</span>
<span class="co">#&gt; 4   Lat_1 Tree_1       1       5</span>
<span class="co">#&gt; 5   Lat_1 Tree_2       1       6</span>
<span class="co">#&gt; 6   Lat_2 Ring_1       2       3</span>
<span class="co">#&gt; 7   Lat_2 Ring_2       2       4</span>
<span class="co">#&gt; 8   Lat_2 Tree_1       2       5</span>
<span class="co">#&gt; 9   Lat_2 Tree_2       2       6</span>
<span class="co">#&gt; 10 Ring_1 Ring_2       3       4</span>
<span class="co">#&gt; 11 Ring_1 Tree_1       3       5</span>
<span class="co">#&gt; 12 Ring_1 Tree_2       3       6</span>
<span class="co">#&gt; 13 Ring_2 Tree_1       4       5</span>
<span class="co">#&gt; 14 Ring_2 Tree_2       4       6</span>
<span class="co">#&gt; 15 Tree_1 Tree_2       5       6</span></code></pre></div>
<p>To read the results in a matrix form:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Creating a comparison matrix:</span>
<span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross_comp_to_matrix.html">cross_comp_to_matrix</a></span><span class="op">(</span>measure <span class="op">=</span> <span class="va">netemdlist</span><span class="op">$</span><span class="va">netemds</span>, cross_comparison_spec <span class="op">=</span> <span class="va">netemdlist</span><span class="op">$</span><span class="va">comp_spec</span><span class="op">)</span>
<span class="va">mat</span>
<span class="co">#&gt;             Lat_1      Lat_2    Ring_1    Ring_2      Tree_1      Tree_2</span>
<span class="co">#&gt; Lat_1  0.00000000 0.07662785 0.1331498 0.1331498 0.203199795 0.203500020</span>
<span class="co">#&gt; Lat_2  0.07662785 0.00000000 0.1746700 0.1746700 0.202314235 0.201886062</span>
<span class="co">#&gt; Ring_1 0.13314978 0.17467002 0.0000000 0.0000000 0.127115909 0.128284610</span>
<span class="co">#&gt; Ring_2 0.13314978 0.17467002 0.0000000 0.0000000 0.127115909 0.128284610</span>
<span class="co">#&gt; Tree_1 0.20319979 0.20231423 0.1271159 0.1271159 0.000000000 0.003359703</span>
<span class="co">#&gt; Tree_2 0.20350002 0.20188606 0.1282846 0.1282846 0.003359703 0.000000000</span></code></pre></div>
<p>Illustration of the multiple NetEmd comparisons based on subgraph counts.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/netemd.plot.html">netemd.plot</a></span><span class="op">(</span>netemdlist<span class="op">=</span><span class="va">netemdlist</span>,clustering_method<span class="op">=</span><span class="st">"ward.D"</span>,main<span class="op">=</span><span class="st">"NetEmd subgraph counts"</span><span class="op">)</span></code></pre></div>
<p><img src="ManyToMany_files/figure-html/netemdorbitsPLOT-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="netemd-using-the-laplacian-and-normalized-laplacian-spectrum">NetEmd using the Laplacian and Normalized Laplacian Spectrum<a class="anchor" aria-label="anchor" href="#netemd-using-the-laplacian-and-normalized-laplacian-spectrum"></a>
</h3>
<p>Pre-compute the Laplacian and normalized Laplacian for each graph considered:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># NetEMD using the Laplacian and normalized Laplacian Spectrum.</span>
<span class="va">SPECT</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>

<span class="co">#This step may take several minutes.</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">glist</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> 
  <span class="va">Lapg</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/laplacian_matrix.html" class="external-link">laplacian_matrix</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">glist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,normalized <span class="op">=</span> <span class="cn">FALSE</span>,sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="va">NLap</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/laplacian_matrix.html" class="external-link">laplacian_matrix</a></span><span class="op">(</span>graph <span class="op">=</span> <span class="va">glist</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,normalized <span class="op">=</span> <span class="cn">TRUE</span>,sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="va">SPECT</span><span class="op">[[</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">glist</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>L.Spectra<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">Lapg</span><span class="op">)</span><span class="op">$</span><span class="va">values</span>, NL.Spectra<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">NLap</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span> 
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">SPECT</span><span class="op">)</span>
<span class="co">#&gt; List of 6</span>
<span class="co">#&gt;  $ Lat_1 : num [1:400, 1:2] 7.95 7.88 7.88 7.8 7.76 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] "L.Spectra" "NL.Spectra"</span>
<span class="co">#&gt;  $ Lat_2 : num [1:1600, 1:2] 7.99 7.97 7.97 7.95 7.94 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] "L.Spectra" "NL.Spectra"</span>
<span class="co">#&gt;  $ Ring_1: num [1:400, 1:2] 4 4 4 4 4 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] "L.Spectra" "NL.Spectra"</span>
<span class="co">#&gt;  $ Ring_2: num [1:400, 1:2] 4 4 4 4 4 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] "L.Spectra" "NL.Spectra"</span>
<span class="co">#&gt;  $ Tree_1: num [1:400, 1:2] 7.01 6.92 6.89 6.73 6.6 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] "L.Spectra" "NL.Spectra"</span>
<span class="co">#&gt;  $ Tree_2: num [1:1600, 1:2] 7.16 7.09 7.05 7.05 6.95 ...</span>
<span class="co">#&gt;   ..- attr(*, "dimnames")=List of 2</span>
<span class="co">#&gt;   .. ..$ : NULL</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] "L.Spectra" "NL.Spectra"</span></code></pre></div>
<p>Compute NetEmd:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">netemdlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netemd_many_to_many.html">netemd_many_to_many</a></span><span class="op">(</span>dhists <span class="op">=</span> <span class="va">SPECT</span>,smoothing_window_width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co">#Use of smoothing window 1 is given for discrete integer distributions. If the network features are considered continuous variables smoothing_window_width equal to zero is recommended.</span>
<span class="co">#&gt; [1] "This function will compute orbits of graphlets up to size 5 using  2  cores. Depending on the density and size of the graphs, this may lead to a large compsumption of RAM."</span>

<span class="va">netemdlist</span>
<span class="co">#&gt; $netemds</span>
<span class="co">#&gt;  [1] 1.276256e-02 2.131502e-01 2.131502e-01 3.227064e-01 3.226407e-01</span>
<span class="co">#&gt;  [6] 2.151625e-01 2.151625e-01 3.242913e-01 3.241844e-01 2.220446e-16</span>
<span class="co">#&gt; [11] 3.869593e-01 3.864726e-01 3.869593e-01 3.864726e-01 4.268586e-03</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $comp_spec</span>
<span class="co">#&gt;    name_a name_b index_a index_b</span>
<span class="co">#&gt; 1   Lat_1  Lat_2       1       2</span>
<span class="co">#&gt; 2   Lat_1 Ring_1       1       3</span>
<span class="co">#&gt; 3   Lat_1 Ring_2       1       4</span>
<span class="co">#&gt; 4   Lat_1 Tree_1       1       5</span>
<span class="co">#&gt; 5   Lat_1 Tree_2       1       6</span>
<span class="co">#&gt; 6   Lat_2 Ring_1       2       3</span>
<span class="co">#&gt; 7   Lat_2 Ring_2       2       4</span>
<span class="co">#&gt; 8   Lat_2 Tree_1       2       5</span>
<span class="co">#&gt; 9   Lat_2 Tree_2       2       6</span>
<span class="co">#&gt; 10 Ring_1 Ring_2       3       4</span>
<span class="co">#&gt; 11 Ring_1 Tree_1       3       5</span>
<span class="co">#&gt; 12 Ring_1 Tree_2       3       6</span>
<span class="co">#&gt; 13 Ring_2 Tree_1       4       5</span>
<span class="co">#&gt; 14 Ring_2 Tree_2       4       6</span>
<span class="co">#&gt; 15 Tree_1 Tree_2       5       6</span></code></pre></div>
<div class="section level4">
<h4 id="illustration-of-the-multiple-netemd-comparisons-based-on-the-laplacian-and-normalized-laplacian-spectra">Illustration of the multiple NetEmd comparisons based on the Laplacian and Normalized Laplacian spectra<a class="anchor" aria-label="anchor" href="#illustration-of-the-multiple-netemd-comparisons-based-on-the-laplacian-and-normalized-laplacian-spectra"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/netemd.plot.html">netemd.plot</a></span><span class="op">(</span>netemdlist<span class="op">=</span><span class="va">netemdlist</span>,clustering_method<span class="op">=</span><span class="st">"ward.D"</span>,main<span class="op">=</span><span class="st">"NetEmd Spectra"</span><span class="op">)</span></code></pre></div>
<p><img src="ManyToMany_files/figure-html/netemdspectrumPLOT%20-1.png" width="768" style="display: block; margin: auto;"></p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="compare-two-networks-via-netdis-and-its-variants">Compare two networks via Netdis and its variants<a class="anchor" aria-label="anchor" href="#compare-two-networks-via-netdis-and-its-variants"></a>
</h2>
<p>(Extracted from Ali et al. (2014)): Netdis counts small subgraphs <span class="math inline">\(w\)</span> on <span class="math inline">\(k\)</span> nodes for all 2-step ego-networks, <span class="math inline">\(k=3,4,5\)</span>. These counts are centred by subtracting the expected number of counts <span class="math inline">\(E_w\)</span>. These centred counts of each network are then compared among one another thus leading to the Netdis statistic.</p>
<div class="section level3">
<h3 id="using-netdis-with-a-reference-or-gold-standard-graph-to-obtain-the-expectations-e_w">Using Netdis with a reference or gold-standard graph to obtain the expectations <span class="math inline">\(E_w\)</span><a class="anchor" aria-label="anchor" href="#using-netdis-with-a-reference-or-gold-standard-graph-to-obtain-the-expectations-e_w"></a>
</h3>
<p>The selection of a gold-standard graph as a substitute for a theoretical <span class="math inline">\(E_w\)</span> could be considered when such graph is known to be a good proxy for <span class="math inline">\(E_w\)</span>, or alternatively as a good reference point for the comparison. This Netdis variant focuses on detecting discrepancies between the networks relative to the ego-network structure of the reference network / gold-standard.</p>
<div class="section level4">
<h4 id="netdis-using-reference-or-gold-standard-networks">Netdis using reference or gold-standard networks<a class="anchor" aria-label="anchor" href="#netdis-using-reference-or-gold-standard-networks"></a>
</h4>
<p>Generation of regular grid, ring and tree-like networks with 400 nodes and 1600 nodes. Reference graphs given by start-like graphs are used as illustration of reference graphs. The plots of these networks illustrate clearly their structural differences.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create networks</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3171</span><span class="op">)</span>
<span class="va">gLat_1</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_lattice.html" class="external-link">graph.lattice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span> 
<span class="va">gLat_2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_lattice.html" class="external-link">graph.lattice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">40</span><span class="op">)</span><span class="op">)</span>  
<span class="va">gRing_1</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_ring.html" class="external-link">make_ring</a></span><span class="op">(</span><span class="fl">20</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> 
<span class="va">gRing_2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_ring.html" class="external-link">make_ring</a></span><span class="op">(</span><span class="fl">40</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>
<span class="va">gTree_1</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html" class="external-link">as.undirected</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_tree.html" class="external-link">make_tree</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">20</span><span class="op">^</span><span class="fl">2</span>,children <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">)</span>
<span class="va">gTree_2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html" class="external-link">as.undirected</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_tree.html" class="external-link">make_tree</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">40</span><span class="op">^</span><span class="fl">2</span>,children <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">)</span>

<span class="co"># Create a random graph to be used as a gold-standard</span>
<span class="va">gst_1</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html" class="external-link">as.undirected</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_star.html" class="external-link">graph.star</a></span><span class="op">(</span><span class="fl">20</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span>
<span class="va">gst_2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html" class="external-link">as.undirected</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/make_star.html" class="external-link">graph.star</a></span><span class="op">(</span><span class="fl">40</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gst_1</span>,vertex.size<span class="op">=</span><span class="fl">0.8</span>,vertex.label<span class="op">=</span><span class="cn">NA</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gst_2</span>,vertex.size<span class="op">=</span><span class="fl">0.8</span>,vertex.label<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></code></pre></div>
<p><img src="ManyToMany_files/figure-html/netdisgoldstandnetworks-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Obtain the comparison via Netdis using each of the reference graph networks.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">glist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Lat_1<span class="op">=</span><span class="va">gLat_1</span>, Lat_2<span class="op">=</span><span class="va">gLat_2</span>, Ring_1<span class="op">=</span><span class="va">gRing_1</span>, Ring_2<span class="op">=</span><span class="va">gRing_1</span>, Tree_1<span class="op">=</span><span class="va">gTree_1</span>, Tree_2<span class="op">=</span><span class="va">gTree_2</span><span class="op">)</span>

<span class="co"># Netdis using the goldstd_1 graph as gold-standard reference point</span>
<span class="va">netdis_mat_gst1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netdis_many_to_many.html">netdis_many_to_many</a></span><span class="op">(</span>graphs <span class="op">=</span> <span class="va">glist</span>, ref_graph <span class="op">=</span> <span class="va">gst_1</span><span class="op">)</span>

<span class="co"># Netdis using the goldstd_2 graph as gold-standard reference point</span>
<span class="va">netdis_mat_gst2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netdis_many_to_many.html">netdis_many_to_many</a></span><span class="op">(</span>graphs <span class="op">=</span> <span class="va">glist</span>, ref_graph <span class="op">=</span> <span class="va">gst_2</span><span class="op">)</span>

<span class="va">netdis_mat_gst1</span>
<span class="co">#&gt; $netdis</span>
<span class="co">#&gt;                 [,1]       [,2]       [,3]       [,4]       [,5]       [,6]</span>
<span class="co">#&gt; netdis3 5.551115e-17 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000</span>
<span class="co">#&gt; netdis4 1.923015e-05 0.08801095 0.08801095 0.05118763 0.05046106 0.08686656</span>
<span class="co">#&gt;               [,7]         [,8]       [,9] [,10]         [,11]    [,12]</span>
<span class="co">#&gt; netdis3 0.00000000 5.551115e-17 0.00000000     0 -1.110223e-16 0.000000</span>
<span class="co">#&gt; netdis4 0.08686656 5.196150e-02 0.05001099     0  1.264028e-01 0.120321</span>
<span class="co">#&gt;                 [,13]    [,14]        [,15]</span>
<span class="co">#&gt; netdis3 -1.110223e-16 0.000000 0.000000e+00</span>
<span class="co">#&gt; netdis4  1.264028e-01 0.120321 3.098708e-05</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $comp_spec</span>
<span class="co">#&gt;    name_a name_b index_a index_b</span>
<span class="co">#&gt; 1   Lat_1  Lat_2       1       2</span>
<span class="co">#&gt; 2   Lat_1 Ring_1       1       3</span>
<span class="co">#&gt; 3   Lat_1 Ring_2       1       4</span>
<span class="co">#&gt; 4   Lat_1 Tree_1       1       5</span>
<span class="co">#&gt; 5   Lat_1 Tree_2       1       6</span>
<span class="co">#&gt; 6   Lat_2 Ring_1       2       3</span>
<span class="co">#&gt; 7   Lat_2 Ring_2       2       4</span>
<span class="co">#&gt; 8   Lat_2 Tree_1       2       5</span>
<span class="co">#&gt; 9   Lat_2 Tree_2       2       6</span>
<span class="co">#&gt; 10 Ring_1 Ring_2       3       4</span>
<span class="co">#&gt; 11 Ring_1 Tree_1       3       5</span>
<span class="co">#&gt; 12 Ring_1 Tree_2       3       6</span>
<span class="co">#&gt; 13 Ring_2 Tree_1       4       5</span>
<span class="co">#&gt; 14 Ring_2 Tree_2       4       6</span>
<span class="co">#&gt; 15 Tree_1 Tree_2       5       6</span>

<span class="va">netdis_mat_gst2</span>
<span class="co">#&gt; $netdis</span>
<span class="co">#&gt;                [,1]       [,2]       [,3]       [,4]       [,5]         [,6]</span>
<span class="co">#&gt; netdis3 0.00000e+00 0.00000000 0.00000000 0.00000000 0.00000000 1.110223e-16</span>
<span class="co">#&gt; netdis4 1.25415e-05 0.09558794 0.09558794 0.06087967 0.06231323 9.521044e-02</span>
<span class="co">#&gt;                 [,7]         [,8]          [,9] [,10]     [,11]         [,12]</span>
<span class="co">#&gt; netdis3 1.110223e-16 5.551115e-17 -1.110223e-16     0 0.0000000 -1.110223e-16</span>
<span class="co">#&gt; netdis4 9.521044e-02 5.999573e-02  5.942206e-02     0 0.1541157  1.486546e-01</span>
<span class="co">#&gt;             [,13]         [,14]       [,15]</span>
<span class="co">#&gt; netdis3 0.0000000 -1.110223e-16 0.00000e+00</span>
<span class="co">#&gt; netdis4 0.1541157  1.486546e-01 5.57962e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $comp_spec</span>
<span class="co">#&gt;    name_a name_b index_a index_b</span>
<span class="co">#&gt; 1   Lat_1  Lat_2       1       2</span>
<span class="co">#&gt; 2   Lat_1 Ring_1       1       3</span>
<span class="co">#&gt; 3   Lat_1 Ring_2       1       4</span>
<span class="co">#&gt; 4   Lat_1 Tree_1       1       5</span>
<span class="co">#&gt; 5   Lat_1 Tree_2       1       6</span>
<span class="co">#&gt; 6   Lat_2 Ring_1       2       3</span>
<span class="co">#&gt; 7   Lat_2 Ring_2       2       4</span>
<span class="co">#&gt; 8   Lat_2 Tree_1       2       5</span>
<span class="co">#&gt; 9   Lat_2 Tree_2       2       6</span>
<span class="co">#&gt; 10 Ring_1 Ring_2       3       4</span>
<span class="co">#&gt; 11 Ring_1 Tree_1       3       5</span>
<span class="co">#&gt; 12 Ring_1 Tree_2       3       6</span>
<span class="co">#&gt; 13 Ring_2 Tree_1       4       5</span>
<span class="co">#&gt; 14 Ring_2 Tree_2       4       6</span>
<span class="co">#&gt; 15 Tree_1 Tree_2       5       6</span></code></pre></div>
<p>To read the results in a matrix form:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Creating a comparison matrix:</span>
<span class="fu"><a href="../reference/cross_comp_to_matrix.html">cross_comp_to_matrix</a></span><span class="op">(</span>measure <span class="op">=</span> <span class="va">netdis_mat_gst1</span><span class="op">$</span><span class="va">netdis</span>, cross_comparison_spec <span class="op">=</span> <span class="va">netdis_mat_gst1</span><span class="op">$</span><span class="va">comp_spec</span><span class="op">)</span>
<span class="co">#&gt; Warning in out[cbind(cross_comparison_spec$index_a,</span>
<span class="co">#&gt; cross_comparison_spec$index_b)] &lt;- measure: number of items to replace is not a</span>
<span class="co">#&gt; multiple of replacement length</span>
<span class="co">#&gt; Warning in out[cbind(cross_comparison_spec$index_b,</span>
<span class="co">#&gt; cross_comparison_spec$index_a)] &lt;- measure: number of items to replace is not a</span>
<span class="co">#&gt; multiple of replacement length</span>
<span class="co">#&gt;               Lat_1        Lat_2       Ring_1     Ring_2       Tree_1</span>
<span class="co">#&gt; Lat_1  0.000000e+00 5.551115e-17 1.923015e-05 0.00000000 8.801095e-02</span>
<span class="co">#&gt; Lat_2  5.551115e-17 0.000000e+00 8.801095e-02 0.00000000 5.118763e-02</span>
<span class="co">#&gt; Ring_1 1.923015e-05 8.801095e-02 0.000000e+00 0.05046106 0.000000e+00</span>
<span class="co">#&gt; Ring_2 0.000000e+00 0.000000e+00 5.046106e-02 0.00000000 0.000000e+00</span>
<span class="co">#&gt; Tree_1 8.801095e-02 5.118763e-02 0.000000e+00 0.00000000 0.000000e+00</span>
<span class="co">#&gt; Tree_2 0.000000e+00 0.000000e+00 8.686656e-02 0.08686656 5.551115e-17</span>
<span class="co">#&gt;              Tree_2</span>
<span class="co">#&gt; Lat_1  0.000000e+00</span>
<span class="co">#&gt; Lat_2  0.000000e+00</span>
<span class="co">#&gt; Ring_1 8.686656e-02</span>
<span class="co">#&gt; Ring_2 8.686656e-02</span>
<span class="co">#&gt; Tree_1 5.551115e-17</span>
<span class="co">#&gt; Tree_2 0.000000e+00</span>

<span class="fu"><a href="../reference/cross_comp_to_matrix.html">cross_comp_to_matrix</a></span><span class="op">(</span>measure <span class="op">=</span> <span class="va">netdis_mat_gst2</span><span class="op">$</span><span class="va">netdis</span>, cross_comparison_spec <span class="op">=</span> <span class="va">netdis_mat_gst2</span><span class="op">$</span><span class="va">comp_spec</span><span class="op">)</span>
<span class="co">#&gt; Warning in out[cbind(cross_comparison_spec$index_a,</span>
<span class="co">#&gt; cross_comparison_spec$index_b)] &lt;- measure: number of items to replace is not a</span>
<span class="co">#&gt; multiple of replacement length</span>

<span class="co">#&gt; Warning in out[cbind(cross_comparison_spec$index_a,</span>
<span class="co">#&gt; cross_comparison_spec$index_b)] &lt;- measure: number of items to replace is not a</span>
<span class="co">#&gt; multiple of replacement length</span>
<span class="co">#&gt;               Lat_1      Lat_2       Ring_1       Ring_2       Tree_1</span>
<span class="co">#&gt; Lat_1  0.0000000000 0.00000000 1.254150e-05 0.000000e+00 9.558794e-02</span>
<span class="co">#&gt; Lat_2  0.0000000000 0.00000000 9.558794e-02 0.000000e+00 6.087967e-02</span>
<span class="co">#&gt; Ring_1 0.0000125415 0.09558794 0.000000e+00 6.231323e-02 1.110223e-16</span>
<span class="co">#&gt; Ring_2 0.0000000000 0.00000000 6.231323e-02 0.000000e+00 1.110223e-16</span>
<span class="co">#&gt; Tree_1 0.0955879398 0.06087967 1.110223e-16 1.110223e-16 0.000000e+00</span>
<span class="co">#&gt; Tree_2 0.0000000000 0.00000000 9.521044e-02 9.521044e-02 5.551115e-17</span>
<span class="co">#&gt;              Tree_2</span>
<span class="co">#&gt; Lat_1  0.000000e+00</span>
<span class="co">#&gt; Lat_2  0.000000e+00</span>
<span class="co">#&gt; Ring_1 9.521044e-02</span>
<span class="co">#&gt; Ring_2 9.521044e-02</span>
<span class="co">#&gt; Tree_1 5.551115e-17</span>
<span class="co">#&gt; Tree_2 0.000000e+00</span></code></pre></div>
<p>Heatmap of the Netdis comparisons:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Network comparisons heatmap with Gold-Standard 1 </span>
<span class="fu"><a href="../reference/netdis.plot.html">netdis.plot</a></span><span class="op">(</span>netdislist <span class="op">=</span> <span class="va">netdis_mat_gst1</span>, whatrow <span class="op">=</span> <span class="fl">2</span>,main <span class="op">=</span> <span class="st">"Netdis GoldStd-1"</span><span class="op">)</span></code></pre></div>
<p><img src="ManyToMany_files/figure-html/netdisgoldstandPLOT%20-1.png" width="768" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">#Network comparisons heatmap with Gold-Standard 2</span>
<span class="fu"><a href="../reference/netdis.plot.html">netdis.plot</a></span><span class="op">(</span>netdislist <span class="op">=</span> <span class="va">netdis_mat_gst2</span>, whatrow <span class="op">=</span> <span class="fl">2</span>,main <span class="op">=</span> <span class="st">"Netdis GoldStd-2"</span><span class="op">)</span></code></pre></div>
<p><img src="ManyToMany_files/figure-html/netdisgoldstandPLOT%20-2.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="netdis-gp-using-a-geometric-poisson-approximation">Netdis-GP: Using a Geometric-Poisson approximation<a class="anchor" aria-label="anchor" href="#netdis-gp-using-a-geometric-poisson-approximation"></a>
</h4>
<p>This variant focuses on detecting more general and global discrepancies between the ego-network structures.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Netdis Geometric-Poisson comparisons</span>
<span class="va">netdis_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netdis_many_to_many.html">netdis_many_to_many</a></span><span class="op">(</span>graphs <span class="op">=</span> <span class="va">glist</span>, ref_graph <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>
<span class="va">netdis_mat</span>
<span class="co">#&gt; $netdis</span>
<span class="co">#&gt;                 [,1]       [,2]       [,3]      [,4]      [,5]       [,6]</span>
<span class="co">#&gt; netdis3 0.000000e+00 0.00000000 0.00000000 0.0000000 0.0000000 0.00000000</span>
<span class="co">#&gt; netdis4 7.705791e-05 0.08924875 0.08924875 0.1465798 0.1292388 0.09027696</span>
<span class="co">#&gt;               [,7]      [,8]         [,9] [,10]     [,11]     [,12]     [,13]</span>
<span class="co">#&gt; netdis3 0.00000000 0.0000000 5.551115e-17     0 0.0000000 0.0000000 0.0000000</span>
<span class="co">#&gt; netdis4 0.09027696 0.1471363 1.325708e-01     0 0.1724175 0.1519148 0.1724175</span>
<span class="co">#&gt;             [,14]       [,15]</span>
<span class="co">#&gt; netdis3 0.0000000 0.000000000</span>
<span class="co">#&gt; netdis4 0.1519148 0.001268919</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $comp_spec</span>
<span class="co">#&gt;    name_a name_b index_a index_b</span>
<span class="co">#&gt; 1   Lat_1  Lat_2       1       2</span>
<span class="co">#&gt; 2   Lat_1 Ring_1       1       3</span>
<span class="co">#&gt; 3   Lat_1 Ring_2       1       4</span>
<span class="co">#&gt; 4   Lat_1 Tree_1       1       5</span>
<span class="co">#&gt; 5   Lat_1 Tree_2       1       6</span>
<span class="co">#&gt; 6   Lat_2 Ring_1       2       3</span>
<span class="co">#&gt; 7   Lat_2 Ring_2       2       4</span>
<span class="co">#&gt; 8   Lat_2 Tree_1       2       5</span>
<span class="co">#&gt; 9   Lat_2 Tree_2       2       6</span>
<span class="co">#&gt; 10 Ring_1 Ring_2       3       4</span>
<span class="co">#&gt; 11 Ring_1 Tree_1       3       5</span>
<span class="co">#&gt; 12 Ring_1 Tree_2       3       6</span>
<span class="co">#&gt; 13 Ring_2 Tree_1       4       5</span>
<span class="co">#&gt; 14 Ring_2 Tree_2       4       6</span>
<span class="co">#&gt; 15 Tree_1 Tree_2       5       6</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/netdis.plot.html">netdis.plot</a></span><span class="op">(</span>netdislist <span class="op">=</span> <span class="va">netdis_mat</span>, whatrow <span class="op">=</span> <span class="fl">2</span>,main <span class="op">=</span> <span class="st">"Netdis-GP"</span><span class="op">)</span></code></pre></div>
<p><img src="ManyToMany_files/figure-html/netdisGPPLOT%20-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="using-netdis-with-no-expectation-e_w0">Using Netdis with no expectation (<span class="math inline">\(E_w=0\)</span>)<a class="anchor" aria-label="anchor" href="#using-netdis-with-no-expectation-e_w0"></a>
</h4>
<p>Comparing the networks via their observed ego-counts without centring them, (equivalent to using expectation equal to zero). This variant thus focuses on detecting small discrepancies between the networks.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Netdis with expectation zero</span>
<span class="va">netdis_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/netdis_many_to_many.html">netdis_many_to_many</a></span><span class="op">(</span>graphs <span class="op">=</span> <span class="va">glist</span>, ref_graph <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">netdis_mat</span>
<span class="co">#&gt; $netdis</span>
<span class="co">#&gt;                 [,1]       [,2]       [,3]       [,4]       [,5]      [,6]</span>
<span class="co">#&gt; netdis3 0.000000e+00 0.00000000 0.00000000 0.00000000 0.00000000 0.0000000</span>
<span class="co">#&gt; netdis4 1.441326e-05 0.09797286 0.09797286 0.06257218 0.06490417 0.0978222</span>
<span class="co">#&gt;              [,7]       [,8]         [,9] [,10]        [,11]     [,12]</span>
<span class="co">#&gt; netdis3 0.0000000 0.00000000 5.551115e-17     0 5.551115e-17 0.0000000</span>
<span class="co">#&gt; netdis4 0.0978222 0.06121592 6.099617e-02     0 1.616725e-01 0.1563972</span>
<span class="co">#&gt;                [,13]     [,14]        [,15]</span>
<span class="co">#&gt; netdis3 5.551115e-17 0.0000000 0.000000e+00</span>
<span class="co">#&gt; netdis4 1.616725e-01 0.1563972 2.932744e-06</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $comp_spec</span>
<span class="co">#&gt;    name_a name_b index_a index_b</span>
<span class="co">#&gt; 1   Lat_1  Lat_2       1       2</span>
<span class="co">#&gt; 2   Lat_1 Ring_1       1       3</span>
<span class="co">#&gt; 3   Lat_1 Ring_2       1       4</span>
<span class="co">#&gt; 4   Lat_1 Tree_1       1       5</span>
<span class="co">#&gt; 5   Lat_1 Tree_2       1       6</span>
<span class="co">#&gt; 6   Lat_2 Ring_1       2       3</span>
<span class="co">#&gt; 7   Lat_2 Ring_2       2       4</span>
<span class="co">#&gt; 8   Lat_2 Tree_1       2       5</span>
<span class="co">#&gt; 9   Lat_2 Tree_2       2       6</span>
<span class="co">#&gt; 10 Ring_1 Ring_2       3       4</span>
<span class="co">#&gt; 11 Ring_1 Tree_1       3       5</span>
<span class="co">#&gt; 12 Ring_1 Tree_2       3       6</span>
<span class="co">#&gt; 13 Ring_2 Tree_1       4       5</span>
<span class="co">#&gt; 14 Ring_2 Tree_2       4       6</span>
<span class="co">#&gt; 15 Tree_1 Tree_2       5       6</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/netdis.plot.html">netdis.plot</a></span><span class="op">(</span>netdislist <span class="op">=</span> <span class="va">netdis_mat</span>, whatrow <span class="op">=</span> <span class="fl">2</span>,main <span class="op">=</span> <span class="st">"Netdis-zero"</span><span class="op">)</span></code></pre></div>
<p><img src="ManyToMany_files/figure-html/netdiszeroPLOT%20-1.png" width="768" style="display: block; margin: auto;"></p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<ul>
<li><p>W. Ali, T. Rito, G. Reinert, F. Sun, and C. M. Deane. Alignment-free protein interaction network comparison. Bioinformatics, 30:i430–i437, 2014.</p></li>
<li><p>L. Ospina-Forero, C. M. Deane, and G. Reinert. Assessment of model fit via network comparison methods based on subgraph counts. Journal of Complex Networks, page cny017, August 2018.</p></li>
<li><p>A. E. Wegner, L. Ospina-Forero, R. E. Gaunt, C. M. Deane, and G. Reinert. Identifying networks with common organizational principles. Journal of Complex networks, 2017.</p></li>
<li><p>F. Picard, J.-J. Daudin, M. Koskas, S. Schbath, and S. Robin. Assessing the exceptionality of network motifs. Journal of Computational Biology, 15(1):1–20, 2008.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Martin O’Reilly.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
